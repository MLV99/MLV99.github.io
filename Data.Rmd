---
title: "Data - Good Plot VS Bad Plot Code Example:"
---

------------------------------------------------------------------------

```{r setup, include=FALSE, warning=FALSE, echo=FALSE, message=FALSE, results=FALSE}

library(tidyverse)
library(ggplot2)
library(plotly)
library(patchwork)
library(ggthemes)
library(RColorBrewer)
library(wesanderson)
library(ggbernie)
library(ggmap)
library(Hmisc)
library(tibble)
library(png)
library(extrafont)
```




## **1. Good Plot** - *neat, clear & comprehensive*

Creating a good plot takes time and dedication to obtain a pleasant data presentation. A crucial step to consider is cleanliness, so that the reader may be able to easily follow the data flow and achieve a certain level of comprehension.

Adding creative details also aids in drawing attention to the data and making it distinguishable from other publications.

The full data set can be accessed directly form the [BCO-DMO BEACON webpage](https://bco-dmo.org/dataset/626102)

## Code:

```{r, fig.dim=c(9,9), include=TRUE, echo=TRUE, warning=FALSE, message=FALSE, results=FALSE, fig.cap="**Figure 1.** Total alkalinity (TA) at coral reef sites from the BEACON project. (A) Map of surveyed sites across the Bermuda Platform. (B) Monthly TA variations (mean95%) throughout the study duration for each of the BEACON sites. (C) Time series of TA variations at each of the surveyed BEACON sites from 2007 - 2012. In all plots, red represents the Bouy 33 (B33) site, orange represents Midlatform (MP) site, green represents the North Channel (NC) site, and blue represents the Tymes Bay (TB) site."}

beacon_data=read_csv("beacon_data copy.csv")

#Select and filter  data to plot
beacon_alk_yr =beacon_data[complete.cases(beacon_data$TA),] %>% 
  select(ReefSiteName, DecimalDate, TA) %>% 
  filter(DecimalDate>=2007 & DecimalDate<=2012)

##### Plot selected data: TA by Year #####
beacon_alk_yr_plot=
  ggplot(beacon_alk_yr, aes (x=DecimalDate, y=TA))+
  scale_color_brewer(palette = "Spectral")+
  geom_line(aes(color=ReefSiteName), size=1, alpha=0.7)+
  xlab("\nYear")+
  ylab("Total Alkalinity (mg/L CaC03)\n")+
  scale_x_continuous(limits=c(2007,2012), breaks=seq(2007,2012,1))+
  scale_y_continuous(limits=c(2260,2430), breaks=seq(2260,2430,20))+
  theme_few()+
  theme(legend.position="none", text=element_text(size=10,  family="Times New Roman"))

  # Add image with patchwork 
image_coral=readPNG("/Users/mileishalyannvelazquez/Downloads/10348958.png", native=TRUE )
beacon_alk_yr_plot_image = beacon_alk_yr_plot+
  ggtitle("C.")+
  inset_element(p=image_coral,
                left=0.02, 
                bottom= 0.1, 
                right=0.1, 
                top=0.5,
                align_to='panel', ignore_tag = TRUE)



 
##### Plot selected data: TA by Month####
beacon_data$Month=as.numeric(substr(beacon_data$Date, 5, 6))-0.5 
beacon_months=beacon_data[complete.cases(beacon_data$Date),]
beacon_months=beacon_data[complete.cases(beacon_data$TA),]
 


beacon_alk_month=beacon_months %>% 
  group_by(ReefSiteName, Month) %>% 
  summarise(ci=list(mean_cl_normal(TA) %>% 
                      rename(Mean=y,lwr=ymin,upr=ymax))) %>% 
  unnest(cols=c(ci)) %>% 
  rename("Site"="ReefSiteName")

beacon_alk_month_plot=
  ggplot()+
  geom_line(data=beacon_alk_month,aes(x=Month, y=Mean,group=Site, color=Site), size=1, alpha=0.7) +
  geom_ribbon(data=beacon_alk_month,aes(x=Month, y=Mean,ymin=lwr, ymax=upr,group=Site,
                                          color=Site, fill=Site), alpha=0.2)+
  scale_shape_manual(values=c(15,16,17,18))+
  scale_color_brewer(palette = "Spectral")+
  xlab("\nMonth")+
  ylab("Total Alkalinity (mg/L CaC03)\n")+
  scale_x_continuous(limits=c(0,12), breaks=seq(0,12,1))+
  scale_y_continuous(limits=c(2260,2430), breaks=seq(2260,2430,20))+
  theme_few()

 

#Add image to plot
image_coral=readPNG("/Users/mileishalyannvelazquez/Downloads/10348958.png", native=TRUE )
beacon_alk_month_plot_image = beacon_alk_month_plot+ 
  ggtitle("B.")+
  theme(legend.direction="horizontal", legend.position='top', text=element_text(size=10,  family="Times New Roman"))+
  inset_element(p=image_coral, 
                left=0.02, 
                bottom= 0.1, 
                right=0.1, 
                top=0.5,
                align_to='panel', ignore_tag=TRUE)


##### Map plot with ggmap####
ReefSites= select(beacon_months, ReefSiteName:Longitude)
            
register_google(key="AIzaSyDrSx7b41xVQBkSL2HhT9fM1TdhO-S6xVU", write=TRUE)

Bermuda <- get_map("Bermuda", maptype='satellite', zoom=11)

 Bermuda <- get_map("Bermuda", maptype='satellite', zoom=11)
 
 bermuda_map=
   ggmap(Bermuda)+
    geom_point(data=ReefSites, 
               aes(x=Longitude, y=Latitude, color=ReefSiteName, shape=ReefSiteName), size=3)+
   geom_text(
     data = ReefSites,
     aes(x = Longitude, y = Latitude, label = ReefSiteName),
     size = 5,
     family="Times New Roman",
      color='white',
     hjust = 1,
     vjust= 0
   )  + 
    scale_shape_manual(values=c(16,16,16,16))+
  scale_x_continuous(limits=c(-64.9, -64.65))+
    scale_y_continuous(limits=c(32.23, 32.45))+
   scale_color_brewer(palette = "Spectral")+
   theme(legend.position = 'none',  legend.key = element_blank(), text=element_text(size=10,family="Times New Roman"))+
   labs(color='Site Location', shape='Site Location')+
   ggtitle("A.")
 ggsave("bermuda_map.pdf",bermuda_map, width=9, height=13)
      
   Figure_TA_map_plot =  
    ( bermuda_map|( beacon_alk_month_plot_image / beacon_alk_yr_plot_image))+ 
     plot_annotation(title= 'Total Alkanility Variations Observed by Year and Month at Bermuda Reef Sites\n', theme=theme(plot.title=element_text(size=16),text=element_text(size=8, family="Times New Roman")))+
plot_layout(guides= 'collect',widths=c(3,5), height= c(3,2))& theme(legend.direction='vertical')
   
ggsave("Figure_TA_map_plot.pdf",Figure_TA_map_plot, width=9, height=9)
#Plots are scaled properly when opened in R studio
Figure_TA_map_plot

```

## **2. Bad Plot** - *Avoid at all costs!*

The following code and generated plot denotes a disastrous example of how to present scientific data.

Certain issues include:

-   Inconsistency in fonts, color, plot tags, and design

-   Poor plot sizes/spacing

-   Legend position, shapes and colors

-   Unrelated image insertion from the presented data

-   Unclear title and plot description

## Code:

```{r, fig.dim= c(11,8), include=TRUE, echo=TRUE, warning=FALSE, message=FALSE, results=FALSE,fig.cap="Fig.2 TA at sites"}

#Bad plot TA & Year 
beacon_dates=beacon_data[complete.cases(beacon_data$Date),]

beacon_alk_yr_bad_plot=
    ggplot(beacon_alk_yr, aes (x=DecimalDate, y=TA))+
    geom_point(aes(color=ReefSiteName, shape=ReefSiteName), size=5,alpha=0.7)+
    scale_shape_manual(values=c(10,13,9,7))+
    geom_bernie(bernie = "sitting")+
    scale_color_brewer(palette = "Pastel2")+
    geom_line(aes(color=ReefSiteName), size=1, alpha=0.5)+
    xlab("\nYear")+
    ylab("Total Alkalinity (mg/L CaC03)\n")+
    labs(color='Reef Sites:', shape='Reef Sites:')+
    plot_annotation(tag_levels = 'I')+
    scale_x_continuous(limits=c(2007,2012), breaks=seq(2007,2012,1))+
    scale_y_continuous(limits=c(2260,2460), breaks=seq(2260,2460,20))+
    theme(panel.background = element_rect(fill = "pink",
                                          
                                          size = 0.5, linetype = "solid"),
          panel.grid.major = element_line(size = 0.5, linetype = 'solid',
                                          colour = "lightblue"), 
          panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
                                          colour = "white"),
          legend.position='bottom', legend.direction = 'vertical',
          text=element_text(size=16,  family="Trattatello")
    )
  
  
  #Bad plot TA & Month 
  beacon_alk_month_bad_plot=
    ggplot()+
    geom_line(data=beacon_alk_month,aes(x=Month, y=Mean,group=Site, color=Site), size=1, alpha=0.7) +
    geom_ribbon(data=beacon_alk_month,aes(x=Month, y=Mean,ymin=lwr, ymax=upr,group=Site,
                                          color=Site, fill=Site), alpha=0.2)+
    scale_shape_manual(values=c(15,16,17,18))+
    scale_color_brewer(palette = "Greens")+
    plot_annotation(tag_levels = 'I')+
    xlab("\nMonth")+
    ylab("Total Alkalinity (mg/L CaC03)\n")+
    scale_x_continuous(limits=c(0,12), breaks=seq(0,12,1))+
    scale_y_continuous(limits=c(2260,2430), breaks=seq(2260,2430,20))+
    theme(legend.position='none')
 
  
  #Bad map plot 
  map=map_data('world',wrap=c(-25,335), ylim=c(-55,75)) 
  
  map_plot=ggplot()+
    geom_polygon(data=map,aes(x=long, y=lat, group=group))+ 
    geom_point(data=beacon_dates,aes(x=Longitude+360, y=Latitude), size=3)+
    scale_shape_manual(values=c(15,18,16,17))+  
    coord_fixed(ratio=1,xlim=c(295,295.4),ylim=c(32.15,32.5), expand=TRUE)+
   
    annotate("text", x=295.11, y=32.307, label="Tynes Bay", size=5, color="black")+ 
    annotate("text", x=295.10, y=32.334, label="Bouy 33", size=5, color="black")+
    annotate("text", x=295.11, y=32.38, label="Mid Platform", size=5, color="black")+
    annotate("text", x=295.14, y=32.42, label="North Channel", size=5, color="black")+
    ylab("Latitude (°N)")+
    xlab("Longitude (°E)")+
    ggtitle("(a)")+
    theme(
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      panel.background=element_rect(fill='grey'), 
      axis.line=element_line(color="black"), 
      text=element_text(size=24),
      legend.position='none',
      plot.title=element_text(hjust=0.5) 
    )

  
    Figure_bad= (map_plot/beacon_alk_yr_bad_plot+beacon_alk_month_bad_plot)+
    plot_layout (guides='auto', widths=c(2,2), height=c(2,2), ncol=3)+ 
    plot_annotation(tag_levels='I', title= '\nTA PLOTS\n')
                  
  Figure_bad
```
